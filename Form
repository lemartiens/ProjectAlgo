Public Class Form1
    Dim L As Double
    Dim H As Double
    Dim vmax As Double
    Dim vmin As Double
    Dim rmin As Double
    Dim rmax As Double
    Dim nbp As Integer
    Dim inf As Integer
    Dim WithEvents timer As Timer
    Dim M As monde
    Dim feuille As Bitmap
    Dim dessin As Graphics

    Private Sub Form1_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
        nbp = CInt(NbPoissonsTxt.Text)
        rmin = 2
        rmax = 10
        vmin = 2
        vmax = 10
        H = 500
        L = 500
        feuille = New Bitmap(250, 500)
        dessin = Graphics.FromImage(feuille)
        PictureBox1.Image = feuille
        Randomize()
        initialiser(M)




        Timer1.Interval = 10
        Timer1.Start()

    End Sub
    Private Sub afficherMonde()
        feuille = New Bitmap(500, 500)
        dessin = Graphics.FromImage(feuille)
        


        uupdatevit(M, 0.01, nbp)
        PictureBox1.Image = feuille
       
    End Sub
    Private Sub initialiser(ByRef m As monde)
        ReDim m.Boids(nbp - 1)
        Dim i As Integer
        Dim lv As Integer
        For i = 0 To nbp - 1
            m.Boids(i).center.X = Rnd() * L
            m.Boids(i).center.Y = Rnd() * H
            m.Boids(i).Rayon = Rnd() * (rmax - rmin) + rmin
            lv = Rnd() * (vmax - vmin) + vmin
            m.Boids(i).orientation = Rnd() * (2 * Math.PI) - Math.PI
            m.Boids(i).vitesse.X = lv * Math.Cos(m.Boids(i).orientation)
            m.Boids(i).vitesse.Y = lv * Math.Sin(m.Boids(i).orientation)
            
        Next
    End Sub
    Private Sub Timer1_Tick(sender As System.Object, e As System.EventArgs)
        afficherMonde()



        uupdate(M, 0.05)


    End Sub
    Private Sub BtnActu_Click(sender As System.Object, e As System.EventArgs) Handles BtnActu.Click
        nbp = CInt(NbPoissonsTxt.Text)

        rmin = 2
        rmax = 10
        vmin = CInt(VitesseMinTxt.Text)
        vmax = CInt(VitesseMaxTxt.Text)
        H = 500
        L = 500
        Randomize()
        initialiser(M)
        initprop(M, nbp, inf)



        Timer1.Interval = 10
        Timer1.Start()
    End Sub
    
    Private Sub init(ByVal lig As Integer, ByVal col As Integer, ByVal pMax As Integer, ByRef g As Grille2D)
        g.L = lig
        g.C = col
        ReDim g.tab(col)(lig)(pMax)
        ReDim g.nbp(col)(lig)
        Dim i, j As Integer
        For i = 0 To col - 1
            For j = 0 To lig - 1
                g.nbp(i)(j) = 0
            Next
        Next
    End Sub
      






'notre bébé orque
Dim droite As sens
    Dim gauche As sens
    Dim haut As sens
    Dim bas As sens

    Private Sub btn_1_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles btn_1.KeyPress
        If e.KeyChar = Chr(Keys.Up) Then
            aller(M, haut, rmax, rmin, vmax, vmin)
        End If
    End Sub
    Private Sub btn_2_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles btn_2.KeyPress
        If e.KeyChar = Chr(Keys.Down) Then
            aller(M, bas, rmax, rmin, vmax, vmin)
        End If
    End Sub
    Private Sub btn_3_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles btn_3.KeyPress
        If e.KeyChar = Chr(Keys.Left) Then
            aller(M, gauche, rmax, rmin, vmax, vmin)
        End If
    End Sub
    Private Sub btn_4_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles btn_4.KeyPress
        If e.KeyChar = Chr(Keys.Right) Then
            aller(M, droite, rmax, rmin, vmax, vmin)
        End If
    End Sub



'A METTRE DANS LE MODULE POUR L'ORQUE:

 Structure Orque
        Dim center As Vec
        Dim vitesse As Vec
        Dim orientation As Double
        Dim Rayon As Double
        Dim RayonGlouton As Double
    End Structure

    Enum sens
        droite
        gauche
        haut
        bas
    End Enum

    Sub aller(ByRef m As monde, ByVal s As sens, ByVal rmax As Integer, ByVal rmin As Integer, ByVal vmax As Integer, ByVal vmin As Integer)

    End Sub






End Class
